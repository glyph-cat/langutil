[![NPM](https://img.shields.io/npm/v/langutil.svg)](https://www.npmjs.com/package/langutil)

Langutil ‚Äî A localization utility for JavaScript that comes with support for React and React Native.

<br/>

[**üíñ Support me on Patreon**](https://patreon.com/chin98edwin_dev)

<br/>

# Table of Contents
<!-- Automatically generated by VS Code -->
- [Table of Contents](#table-of-contents)
- [Installation](#installation)
- [Basic Usage](#basic-usage)
- [Using with React](#using-with-react)
- [Testing Recipes](#testing-recipes)
- [Error Codes](#error-codes)
- [Migrating from v3 and below](#migrating-from-v3-and-below)

# Installation

```sh
# NPM
npm i langutil

# Yarn
yarn add langutil
```

<br/>

# Basic Usage

```js
// ## Initialization

import { createLangutilCore } from 'langutil'

// * The 1st parameter should be a dictionary
// * The 2nd parameter should be a language key from your dictionary
// * The 3rd parameter is an object where you can set `auto: true`
//   to enable auto-detect
const dictionary = {
  en: {
    HELLO: 'Hello',
    HELLO_PARAM_AND_PARAM: 'Hello, %p and %p',
    HELLO_NAME_AND_NAME: 'Hello, {:name1} and {:name2}',
  },
  'zh-Hans': {
    HELLO: 'ÂìàÂíØ',
    HELLO_PARAM_AND_PARAM: '%p„ÄÅ%pÔºå‰Ω†‰ª¨Â•Ω',
    HELLO_NAME_AND_NAME: '{:name1}„ÄÅ{:name2}Ôºå‰Ω†‰ª¨Â•Ω',
  },
}
const AppLocalizationCore = createLangutilCore(dictionary, 'en', { auto: true })

// ## Set language
AppLocalizationCore.setLanguage('en') // Basic
AppLocalizationCore.setLanguage('en', { auto: true }) // With auto-detect

// ## Get language
const language = AppLocalizationCore.getLanguage()
console.log(language) // en

// ## Get localized content
const a = AppLocalizationCore.localize('HELLO')
console.log(a) // Hello

// ## Get localized content with dynamic values (array)
const b = AppLocalizationCore.localize('HELLO_PARAM_AND_PARAM', ['John', 'Jane'])
console.log(b) // Hello, John and Jane

// ## Get localized content with dynamic values (object)
const c = AppLocalizationCore.localize('HELLO_PARAM_AND_PARAM', {
  name1: 'Jack',
  name2: 'Jill',
})
console.log(c) // Hello, Jack and Jill

// ## Get localized content (alternative syntax)
const d = AppLocalizationCore.localize({
  keyword: 'HELLO_PARAM_AND_PARAM',
  param: { name1: 'Foo', name2: 'Bar' },
})
console.log(d) // Hello, Foo and Bar

```

Langutil is packed with many more methods such as `localizeExplicitly`,`localizeFromScratch`, `setLanguage`, `setDictionary`, `appendDictionary`, `resolveLanguage`, and `getAllLanguages`. You can inspect the TypeScript Definitions in `index.d.ts` of the package's folder to find out more.

<br/>

# Using with React

```js
import React from 'react'
import { useLang, withLang } from 'langutil/react'

function UsingHook() {
  const langState = useLang(AppLocalizationCore)
  return <h1>{langState.localize('HELLO')}</h1>
}

class UsingHigherOrderComponent extends React.Component {
  render() {
    const { langState } = this.props
    return <h1>{langState.localize('HELLO')}</h1>
  }
}
```

<br/>

# Testing Recipes

You can check if your dictionary contains missing localizations with the code snippet below. The code below uses [Jest](https://jestjs.io).

```js
import dictionary from './path-to-your-dictionary'

describe('Localizations are tally', () => {
  const languageStack = Object.keys(dictionary)
  const firstLanguage = languageStack[0]
  const firstKeywordStack = Object.keys(dictionary[firstLanguage]).sort()
  for (let i = 1; i < languageStack.length; i++) {
    const language = languageStack[i]
    it(`Comparing ${firstLanguage} - ${language}`, () => {
      const keywordStack = Object.keys(dictionary[language]).sort()
      expect(firstKeywordStack).toStrictEqual(keywordStack)
    })
  }
})
```

<br/>

# Error Codes
In production builds, these error codes are thrown instead of the usual messages.

* **`LangutilE1,x`**<br/>
Expected 'param' to be an array or object but got `x`

* **`LangutilE2,x`**<br/>
Expected 'options' to be an object but got `x`

* **`LangutilE3,x`**<br/>
Expected dictionary to be an object but got `x`

* **`LangutilE4,x`**<br/>
Prop conflict for 'langState' in `x`

<br/>

# Migrating from v3 and below

Sad enough to say, I am no longer able to maintain this library with a pretty docs site. This includes a proper migration guide as well.

But this README file should be more than enough to grasp the concept of the new version. It still has familiar method names such as `localize`, `setLanguage` and `setDictionary`, except for a few key changes highlighted below:

Here are some of the key changes summarized:
* You need to create a `LangutilCore` before you can start localizing content;
* Dictionaries must now be structured by language first; 
* Case formatting features have been removed, there are other libraries out there that handles casings waaay better than Langutil.

Although this is one step extra, it actually brings a few benefits. There may be cases where your website needs to display different languages in different containers or canvases and this can be useful. For example, a novel reading website, where novels might only be written in limited languages but the website itself supports 20+ languages.

Of course, that quite a crazy example, but even if your app is going to need just one `LangutilCore`, you can still benefit from TypeScript autocomplete thanks to the factory pattern in v4. Cheers üçª

![TypeScript autocomplete - keywords](https://raw.githubusercontent.com/chin98edwin/langutil/main/assets/ts-autocomplete-keywords.png)

<br/>
